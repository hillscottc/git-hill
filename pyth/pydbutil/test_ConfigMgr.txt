

Run ./ConfigMgr.py -v  to run these tests.


>>> #from pydbutil.ConfigMgr import ConfigMgr
>>> from ConfigMgr import ConfigMgr

Init with a dataset.
>>> cm = ConfigMgr(dbsource='input/DbSet.data.csv')

Set path to one file.
>>> cm = ConfigMgr(dbsource='input/DbSet.data.csv').set_path('input/test.config')
Set filelist to ['input/test.config']

Set path to a dir.
>>> cm = ConfigMgr(dbsource='input/DbSet.data.csv').set_path('input/')
Set filelist to ['input/test.config', 'input/test2.config']

Set path to one file, check.

>>> cm = ConfigMgr(dbsource='input/DbSet.data.csv', path='input/test.config')
Set filelist to ['input/test.config']
>>> cm.check()
File : /Users/hills/git-hill/pyth/pydbutil/input/test.config
line 69:
     ...onnectionString="Data Source=Usfshwssql094;Initial Catalog=RDxETL...
line 74:
     ...ta Source=Usfshwssql094;Initial Catalog=RDxETL;Integrated Securit...
line 78:
     ...ta Source=Usfshwssql094;Initial Catalog=RDxETL;Integrated Securit...
line 82:
     ...ta Source=Usfshwssql089;Initial Catalog=RDxReport;Integrated Secu...
<BLANKLINE>
4 matches in file input/test.config
<BLANKLINE>

Set path to dir, check the files.

>>> cm.set_path('input/')
Set filelist to ['input/test.config', 'input/test2.config']
>>> cm.check()
File : /Users/hills/git-hill/pyth/pydbutil/input/test.config
<BLANKLINE>
File : /Users/hills/git-hill/pyth/pydbutil/input/test2.config
<BLANKLINE>
4 matches in file input/test.config
4 matches in file input/test2.config
<BLANKLINE>
8 TOTAL matches.


Set path to one file, change to prod env.

>>> cm = ConfigMgr(dbsource='input/DbSet.data.csv', path='input/test.config')
Set filelist to ['input/test.config']
>>> cm.handle_xml(env='prod')
File: /Users/hills/git-hill/pyth/pydbutil/input/test.config
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql077
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql077
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql077
Conn change: RDxReport connection from Usfshwssql089 to usfshwssql084
<BLANKLINE>
<BLANKLINE>
4 matches in file input/test.config
<BLANKLINE>


Write new file.
>>> cm.handle_xml(write=True)
File: /Users/hills/git-hill/pyth/pydbutil/input/test.config
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql077
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql077
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql077
Conn change: RDxReport connection from Usfshwssql089 to usfshwssql084
<BLANKLINE>
Wrote /Users/hills/git-hill/pyth/pydbutil/output/test.config
<BLANKLINE>
4 matches in file input/test.config
<BLANKLINE>


Set path to dir, change to dev env.

>>> cm.set_path('input/')
Set filelist to ['input/test.config', 'input/test2.config']
>>> cm.handle_xml(env='dev', write=False)
File: /Users/hills/git-hill/pyth/pydbutil/input/test.config
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql104
Conn change: RDxReport connection from Usfshwssql089 to usfshwssql104\RIGHTSDEV_2
<BLANKLINE>
File: /Users/hills/git-hill/pyth/pydbutil/input/test2.config
Conn change: RDxETL connection from Usfshwssql077 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql077 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql077 to usfshwssql104
Conn change: RDxReport connection from Usfshwssql084 to usfshwssql104\RIGHTSDEV_2
<BLANKLINE>
<BLANKLINE>
4 matches in file input/test.config
4 matches in file input/test2.config
<BLANKLINE>
8 TOTAL changes.


Write the dir of changes
>>> cm.handle_xml(write=True)
File: /Users/hills/git-hill/pyth/pydbutil/input/test.config
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql094 to usfshwssql104
Conn change: RDxReport connection from Usfshwssql089 to usfshwssql104\RIGHTSDEV_2
<BLANKLINE>
Wrote /Users/hills/git-hill/pyth/pydbutil/output/test.config
File: /Users/hills/git-hill/pyth/pydbutil/input/test2.config
Conn change: RDxETL connection from Usfshwssql077 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql077 to usfshwssql104
Conn change: RDxETL connection from Usfshwssql077 to usfshwssql104
Conn change: RDxReport connection from Usfshwssql084 to usfshwssql104\RIGHTSDEV_2
<BLANKLINE>
Wrote /Users/hills/git-hill/pyth/pydbutil/output/test2.config
<BLANKLINE>
4 matches in file input/test.config
4 matches in file input/test2.config
<BLANKLINE>
8 TOTAL changes.


