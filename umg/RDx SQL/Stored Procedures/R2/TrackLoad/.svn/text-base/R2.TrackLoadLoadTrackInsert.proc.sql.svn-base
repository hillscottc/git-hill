-- =============================================
-- Author:		Valentin Kantchev
-- Create date: 05/20/2009
-- Description:	Inserts records in R2.LoadTrack
-- =============================================
CREATE PROCEDURE [R2].[TrackLoadLoadTrackInsert]
AS
BEGIN
	insert into R2.LoadTrack
	select
		[RELEASE_ID] = l.[RELEASE_ID]
		,[TRACK_GROUP_ID] = l.[TRACK_GROUP_ID]
		,[GROUP_TITLE] = l.[GROUP_TITLE]
		,[GROUP_VERSION_TITLE] = l.[GROUP_VERSION_TITLE]
		,[GROUP_SEQUENCE_NO] = l.[GROUP_SEQUENCE_NO]
		,[GROUP_RESOURCE_GROUP_ID] = l.[GROUP_RESOURCE_GROUP_ID]
		,[TRACK_ID] = l.[TRACK_ID]
		,[SEQUENCE_NO] = l.[SEQUENCE_NO]
		,[TRACK_RELEASE_INDICATOR] = l.[TRACK_RELEASE_INDICATOR]
		,[TRACK_TIME] = l.[TRACK_TIME]
		,[FORMATTED_TRACK_TIME] = l.[FORMATTED_TRACK_TIME]
		,[PAUSE_TIME] = l.[PAUSE_TIME]
		,[FORMATTED_PAUSE_TIME] = l.[FORMATTED_PAUSE_TIME]
		,[USE_VERSION_TITLE_INDICATOR] = l.[USE_VERSION_TITLE_INDICATOR]
		,[USE_TITLE_EXTENSION_INDICATOR] = l.[USE_TITLE_EXTENSION_INDICATOR]
		,[TRACK_ARTIST_OVERRIDE] = l.[TRACK_ARTIST_OVERRIDE]
		,[TRACK_TITLE_OVERRIDE] = l.[TRACK_TITLE_OVERRIDE]
		,[TRACK_VERSION_TITLE_OVERRIDE] = l.[TRACK_VERSION_TITLE_OVERRIDE]
		,[TRACK_TITLE_EXTENSION_OVERRIDE] = l.[TRACK_TITLE_EXTENSION_OVERRIDE]
		,[RESOURCE_INDEX_GROUP_ID] = l.[RESOURCE_INDEX_GROUP_ID]
		,[MATRIX_ID] = l.[MATRIX_ID]
		,[SOURCE_CATALOG_NUMBER] = l.[SOURCE_CATALOG_NUMBER]
		,[SOURCE_SEQUENCE_NO] = l.[SOURCE_SEQUENCE_NO]
		,[GHOST_INDICATOR] = l.[GHOST_INDICATOR]
		,[IMAGE_RESOURCE_ID] = l.[IMAGE_RESOURCE_ID]
		,[IMAGE_ISRC] = l.[IMAGE_ISRC]
		,[LICENSING_CREDIT] = l.[LICENSING_CREDIT]
		,[PRINT_MEDLEY_INDICATOR] = l.[PRINT_MEDLEY_INDICATOR]
		,[TRACK_NOTES] = l.[TRACK_NOTES]
		,[TRACK_AVAILABLE_INDICATOR] = l.[TRACK_AVAILABLE_INDICATOR]
		,[RESOURCE_ID] = l.[RESOURCE_ID]
		,[ACCOUNT_ID] = l.[ACCOUNT_ID]
		,[ISRC] = l.[ISRC]
		,[ORIGINATING_COUNTRY_ID] = l.[ORIGINATING_COUNTRY_ID]
		,[ORIGINATING_FAMILY_ID] = l.[ORIGINATING_FAMILY_ID]
		,[ORIGINATING_COMPANY_ID] = l.[ORIGINATING_COMPANY_ID]
		,[ORIGINATING_DIVISION_ID] = l.[ORIGINATING_DIVISION_ID]
		,[ORIGINATING_LABEL_ID] = l.[ORIGINATING_LABEL_ID]
		
		,CHANGE_CODE = l.CHANGE_CODE 
		,CHANGE_DATE_TIME = l.CHANGE_DATE_TIME
		,[WORKFLOW_CODE] = 'E'
		
	from 
		R2.LoadTrackLocal l 
		inner join R2.LoadTrackLocalDriver ld 
			on 
				l.RELEASE_ID = ld.RELEASE_ID and l.RESOURCE_ID = ld.RESOURCE_ID 
				and l.GROUP_SEQUENCE_NO = ld.GROUP_SEQUENCE_NO and l.SEQUENCE_NO = ld.SEQUENCE_NO 
				and l.[COMPANY_ID] = ld.[COMPANY_ID]
	where 
		ld.[WORKFLOW_CODE] = 'T'
		and
		l.[WORKFLOW_CODE] = 'LT' 
END
