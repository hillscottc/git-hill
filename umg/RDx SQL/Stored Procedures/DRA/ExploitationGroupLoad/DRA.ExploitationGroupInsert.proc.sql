-- ============================================
-- Description:	Inserts records in DRA.ExploitationGroup
-- =============================================
CREATE PROCEDURE DRA.ExploitationGroupInsert 
AS
BEGIN
	insert into DRA.ExploitationGroup
	select 
		l.*, 
		CHANGE_CODE = N'I', 
		CHANGE_DATE_TIME = getdate(),
		WORKFLOW_CODE = 'L'
	from 
		DRA.ExploitationGroup t
		right outer join DRA.LoadExploitationGroup l on t.EXPLOITATION_GROUP_ID = l.EXPLOITATION_GROUP_ID
	where
		t.EXPLOITATION_GROUP_ID is null
		
	-- update row counts		
	exec DRA.TransformLogTaskInsert 'DRA.ExploitationGroup', @@rowcount, 'I'
		
END
GO