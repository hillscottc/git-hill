CREATE PROCEDURE R2.ResourceExtractLoadResourceLocalInsert
AS

insert into R2.LoadResourceLocal
select * from 
openquery (R2,
'
SELECT 
   R.RESOURCE_ID, 
   R.ACCOUNT_ID, 
   R.ISRC, 
   R.RESOURCE_TYPE, 
   R.RESOURCE_TYPE_DESC, 
   R.ARTIST_LIST, 
   R.ORIGINAL_PROJECT_ID, 
   R.TIME, 
   R.FORMATTED_TIME, 
   R.MUSIC_TYPE, 
   R.MUSIC_TYPE_DESC, 
   R.LANGUAGE_NO, 
   R.LANGUAGE_DESC, 
   R.MISCELLANEOUS_CREDITS, 
   R.SAMPLE_CREDITS, 
   R.TECHNICAL_FORMAT, 
   R.TECHNICAL_FORMAT_DESC, 
   R.ANALOG_DIGITAL_CODE, 
   R.ANALOG_DIGITAL_CODE_DESC, 
   R.SAMPLING_FREQUENCY, 
   R.SAMPLING_FREQUENCY_DESC, 
   R.BIT_DEPTH, 
   R.BIT_DEPTH_DESC, 
   R.SCORE_PUBLISHER_ID, 
   R.SCORE_PUBLISHER_DESC, 
   R.SEARCH_INFORMATION, 
   R.SESSION_NAME, 
   R.SESSION_COUNTRY_ID, 
   R.SESSION_COUNTRY_NAME, 
   R.SESSION_LOCATION_ID, 
   R.SESSION_LOCATION_DESC, 
   R.SESSION_SETTING, 
   R.SESSION_SETTING_DESC, 
   R.SESSION_UNION_TYPE, 
   R.SESSION_UNION_TYPE_DESC, 
   R.SESSION_PERFORMANCE_TYPE, 
   R.SESSION_PERFORMANCE_TYPE_DESC, 
   R.SESSION_START_DATE_YEAR, 
   R.SESSION_START_DATE_MONTH, 
   R.SESSION_START_DATE_DAY, 
   R.SESSION_START_DATE, 
   R.SESSION_END_DATE_YEAR, 
   R.SESSION_END_DATE_MONTH, 
   R.SESSION_END_DATE_DAY, 
   R.SESSION_END_DATE, 
   R.ORIGINAL_MATRIX_NUMBER, 
   R.MASTERING_TRACK_COUNT, 
   R.CATEGORY, 
   R.CATEGORY_DESC, 
   R.FORMAT, 
   R.FORMAT_DESC, 
   R.COLOR_MODE, 
   R.COLOR_MODE_DESC, 
   R.RESOLUTION, 
   R.RESOLUTION_DESC, 
   R.MEASUREMENT, 
   R.MEASUREMENT_DESC, 
   R.HEIGHT, 
   R.WIDTH, 
   R.VIDEO_TYPE, 
   R.VIDEO_TYPE_DESC, 
   R.VIDEO_PRODUCTION_NUMBER, 
   R.NOTES, 
   R.ISAN, 
   R.AVAILABLE_INDICATOR, 
   R.RESOURCE_LOCAL_ID, 
   R.TITLE, 
   R.TITLE_OVERRIDE, 
   R.VERSION_TITLE, 
   R.VERSION_TITLE_OVERRIDE, 
   R.TITLE_EXTENSION, 
   R.TITLE_EXTENSION_OVERRIDE, 
   R.FORMATTED_TITLE, 
   R.ARTIST_OVERRIDE, 
   R.PC_NOTICE_YEAR, 
   R.PC_NOTICE_COMPANY_ID, 
   R.PC_NOTICE_COMPANY_NAME, 
   R.PC_NOTICE_EXTENSION, 
   R.FORMATTED_PC_NOTICE, 
   R.VERSION_TYPE, 
   R.VERSION_TYPE_DESC, 
   R.E_MARKETING_TAG, 
   R.E_RELEASE_LABEL, 
   R.E_OWNING_LABEL, 
   R.DESCRIPTION, 
   R.VIDEO_NETWORK, 
   R.VIDEO_NETWORK_DESC, 
   R.VIDEO_SEASON_ID, 
   R.VIDEO_RELEASE_YEAR, 
   R.VIDEO_RATING, 
   R.VIDEO_RATING_DESC, 
   R.VIDEO_SHORT_DESCRIPTION, 
   R.VIDEO_LONG_DESCRIPTION, 
   R.ASPECT_RATIO, 
   R.ASPECT_RATIO_DESC, 
   R.MOVIE_RATING, 
   R.MOVIE_RATING_DESC, 
   R.RATING_REASON, 
   R.ORIGINAL_CATALOG_NUMBER, 
   R.PREVIEW_START_TIME, 
   R.FORMATTED_PREVIEW_START_TIME, 
   R.PREVIEW_START_TIME_FRACTION, 
   R.PREVIEW_STOP_TIME, 
   R.FORMATTED_PREVIEW_STOP_TIME, 
   R.PREVIEW_STOP_TIME_FRACTION, 
   R.RESOURCE_COMPANY_LINK_ID, 
   R.COUNTRY_ID, 
   R.FAMILY_ID, 
   R.COMPANY_ID, 
   R.DIVISION_ID, 
   R.LABEL_ID, 
   R.ORIGINATING_COUNTRY_ID, 
   R.ORIGINATING_FAMILY_ID, 
   R.ORIGINATING_COMPANY_ID, 
   R.ORIGINATING_DIVISION_ID, 
   R.ORIGINATING_LABEL_ID, 
   R.ORIGINATING_INDICATOR, 
   R.DQ_STATUS, 
   R.DQ_STATUS_DESC, 
   R.RIGHTS_TYPE, 
   R.RIGHTS_TYPE_DESC, 
   R.RIGHTS_OWNER_ID, 
   R.RIGHTS_OWNER_DESC, 
   R.GENRE, 
   R.GENRE_DESC, 
   R.LOCAL_NOTES,
   DK.ACTION_CODE CHANGE_CODE,
   DK.GENERIC_DATE CHANGE_DATE_TIME,
   ''E'' WORKFLOW_CODE
FROM 
    IFE.RESOURCE_DETAIL R, 
    PARTNER.DRIVER_KEY DK
WHERE 
    R.ACCOUNT_ID = 0
    
    AND R.RESOURCE_ID = DK.UNIQUE_ID 
    AND R.COMPANY_ID = DK.LOCAL_DESIGNATION_ID
    AND R.RESOURCE_COMPANY_LINK_ID = DK.UNIQUE_LOC_ID
    
    AND DK.REPERTOIRE_TYPE = ''RECORD''
    AND DK.GENERIC_STRING = ''P''
')
;