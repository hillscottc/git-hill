-- =============================================
-- Description:	Loads records from CTX.CONTRAXX.CTV_DATA_EXPLOITATION into CTX.LoadDataExploitation
-- =============================================
CREATE PROCEDURE CTX.ExtractLoadDataExploitationInsert(@contractID numeric (38, 0))
AS
begin
	insert into CTX.LoadDataExploitation
	(
		ORGANIZATION_ID, 
		CONTRACT_ID, 
		RESTRICTIONS_CATEGORY, 
		RESTRICTIONS_ITEM, 
		RIGHT_ACQUIRED, 
		TYPE_OF_RESTRICTION, 
		WHEN_TO_CONSENT_CONSULT, 
		PERIOD_OF_RESTRICTION, 
		RESTRICTION_END_DATE, 
		DOWNLOAD_BY, 
		COMPLETE_PRODUCT_ONLY, 
		HOLDBACKS, 
		NOTES, 
		ON_RESTRICTED_ARTIST_LIST, 
		RESTRICTED_ONLINE_MOBILE_USE, 
		RESTRICTED_MOBILE_AUDIO_USE, 
		RESTRICTED_MOBILE_VIDEO_USE, 
		RESTRICTED_ONLINE_AUDIO_USE, 
		RESTRICTED_ONLINE_VIDEO_USE
	)
	execute 
	('
		SELECT 
			C.ORGANIZATION_ID, 
			C.CONTRACT_ID, 
			C.RESTRICTIONS_CATEGORY, 
			C.RESTRICTIONS_ITEM, 
			C.RIGHT_ACQUIRED, 
			C.TYPE_OF_RESTRICTION, 
			C.WHEN_TO_CONSENT_CONSULT, 
			C.PERIOD_OF_RESTRICTION, 
			C.RESTRICTION_END_DATE, 
			C.DOWNLOAD_BY, 
			C.COMPLETE_PRODUCT_ONLY, 
			C.HOLDBACKS, 
			C.NOTES, 
			C.ON_RESTRICTED_ARTIST_LIST, 
			C.RESTRICTED_ONLINE_MOBILE_USE, 
			C.RESTRICTED_MOBILE_AUDIO_USE, 
			C.RESTRICTED_MOBILE_VIDEO_USE, 
			C.RESTRICTED_ONLINE_AUDIO_USE, 
			C.RESTRICTED_ONLINE_VIDEO_USE
		FROM 
			CONTRAXX.CTV_DATA_EXPLOITATION C
		WHERE
			C.CONTRACT_ID = ' + @contractID
	) at CTX
end;	


