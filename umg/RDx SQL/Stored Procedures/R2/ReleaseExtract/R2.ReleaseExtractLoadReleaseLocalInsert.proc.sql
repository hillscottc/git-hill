CREATE PROCEDURE R2.ReleaseExtractLoadReleaseLocalInsert
AS

insert into R2.LoadReleaseLocal
select * from 
openquery (R2,
'
SELECT
   RD.RELEASE_ID,
   RD.ACCOUNT_ID,
   RD.UPC,
   RD.CONTEXT_UPC,
   RD.UPC_TYPE,
   RD.UPC_AUTO_DATE,
   RD.GRID,
   RD.CONTEXT_RELEASE_ID,
   RD.CONTEXT_TYPE,
   RD.ARTIST_LIST,
   RD.TOTAL_TRACKS,
   RD.TOTAL_TIME,
   RD.FORMATTED_TOTAL_TIME,
   RD.ORIGINAL_PROJECT_ID,
   RD.CONFIG_ID,
   RD.CONFIG_DESC,
   RD.CONFIG_SCOPE,
   RD.UNIQUE_INDICATOR,
   RD.PACKAGE_INDICATOR,
   RD.SOUNDTRACK_INDICATOR,
   RD.MUSIC_TYPE,
   RD.MUSIC_TYPE_DESC,
   RD.RELEASE_TYPE,
   RD.RELEASE_TYPE_DESC,
   RD.P_NOTICE_COMPILATION,
   RD.P_NOTICE_COMPILATION_DESC,
   RD.PACKAGING_DEFINITION,
   RD.VIDEO_TYPE,
   RD.VIDEO_TYPE_DESC,
   RD.NOTES,
   RD.MISCELLANEOUS_CREDITS,
   RD.CRA_PROJECT_ID,
   RD.SEARCH_INFORMATION,
   RD.DIGITAL_FORMAT,
   RD.DIGITAL_FORMAT_DESC,
   RD.THEMATIC_CATEGORY,
   RD.THEMATIC_CATEGORY_DESC,
   RD.CLASSICAL_CATEGORY,
   RD.CLASSICAL_CATEGORY_DESC,
   RD.CLASSICAL_SUBCATEGORY,
   RD.CLASSICAL_SUBCATEGORY_DESC,
   RD.AVAILABILITY_OVERRIDE_REASON,
   RD.RELEASE_LOCAL_ID,
   RD.TITLE,
   RD.TITLE_OVERRIDE,
   RD.VERSION_TITLE,
   RD.VERSION_TITLE_OVERRIDE,
   RD.FORMATTED_TITLE,
   RD.ARTIST_OVERRIDE,
   RD.VERSION_TYPE,
   RD.VERSION_TYPE_DESC,
   RD.P_NOTICE_YEAR,
   RD.P_NOTICE_COMPANY_ID,
   RD.P_NOTICE_COMPANY_NAME,
   RD.P_NOTICE_EXTENSION,
   RD.FORMATTED_P_NOTICE,
   RD.C_NOTICE_YEAR,
   RD.C_NOTICE_COMPANY_ID,
   RD.C_NOTICE_COMPANY_NAME,
   RD.C_NOTICE_EXTENSION,
   RD.FORMATTED_C_NOTICE,
   RD.SERIES_ID,
   RD.SERIES_TITLE,
   RD.VIDEO_NETWORK,
   RD.VIDEO_NETWORK_DESC,
   RD.VIDEO_SEASON_ID,
   RD.VIDEO_ORIGINAL_RELEASE_YEAR,
   RD.VIDEO_RATING,
   RD.VIDEO_RATING_DESC,
   RD.VIDEO_SHORT_DESCRIPTION,
   RD.VIDEO_LONG_DESCRIPTION,
   RD.E_MARKETING_TAG,
   RD.E_RELEASE_LABEL,
   RD.NPSC,
   RD.VOD_TYPE,
   RD.VOD_TYPE_DESC,
   RD.RELEASE_COMPANY_LINK_ID,
   RD.COUNTRY_ID,
   RD.FAMILY_ID,
   RD.COMPANY_ID,
   RD.DIVISION_ID,
   RD.LABEL_ID,
   RD.ORIGINATING_COUNTRY_ID,
   RD.ORIGINATING_FAMILY_ID,
   RD.ORIGINATING_COMPANY_ID,
   RD.ORIGINATING_DIVISION_ID,
   RD.ORIGINATING_LABEL_ID,
   RD.ORIGINATING_INDICATOR,
   RD.STATUS,
   RD.STATUS_DESC,
   RD.ISSUING_EMPLOYEE_NO,
   RD.ISSUING_EMPLOYEE_NAME,
   RD.ROYALTY_ADMIN,
   RD.ROYALTY_ADMIN_DESC,
   RD.CATALOG_NUMBER,
   RD.GENRE,
   RD.GENRE_DESC,
   RD.RELEASE_DATE_YEAR,
   RD.RELEASE_DATE_MONTH,
   RD.RELEASE_DATE_DAY,
   RD.RELEASE_DATE_DISPLAY,
   RD.LOCAL_NOTES,
   RD.DQ_STATUS,
   RD.DQ_STATUS_DESC,
   DK.ACTION_CODE CHANGE_CODE,
   DK.GENERIC_DATE CHANGE_DATE_TIME,
   ''E'' WORKFLOW_CODE
FROM 
    IFE.RELEASE_DETAIL RD, 
    PARTNER.DRIVER_KEY DK
WHERE 
    RD.STATUS = ''F'' AND RD.ACCOUNT_ID = 0
    
    AND RD.RELEASE_ID = DK.UNIQUE_ID 
    AND RD.COMPANY_ID = DK.LOCAL_DESIGNATION_ID
    AND RD.RELEASE_COMPANY_LINK_ID = DK.UNIQUE_LOC_ID
    
    AND DK.REPERTOIRE_TYPE = ''PRODCT''
    AND DK.GENERIC_STRING = ''P''
')
;