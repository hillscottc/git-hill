-- ============================================
-- Description:	Updates records in DRA.Exploitation
-- =============================================
CREATE PROCEDURE DRA.ExploitationUpdate 
AS
BEGIN
	update DRA.Exploitation
	set
		[EXPLOITATION_ID] = l.[EXPLOITATION_ID]
		,[EXPLOITATION_GROUP_ID] = l.[EXPLOITATION_GROUP_ID]
		,[NAME] = l.[NAME]
		,[SEQUENCE_NO] = l.[SEQUENCE_NO]

		,CHANGE_CODE = N'U'
		,CHANGE_DATE_TIME = getdate()
		,WORKFLOW_CODE = 'L'
	from 
		DRA.Exploitation t
		inner join DRA.LoadExploitation l on t.EXPLOITATION_ID = l.EXPLOITATION_ID
		
	-- update row counts		
	exec DRA.TransformLogTaskInsert 'DRA.Exploitation', @@rowcount, 'U'
		
END
GO